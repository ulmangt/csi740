>> % Test a small 2x2 matrix

>> A = [ 1  2 ;  4  4 ]

A =

     1     2
     4     4

>> [W,R] = house(A)

W =

    0.7882         0
    0.6154   -1.0000


R =

   -4.1231   -4.3656
   -0.0000    0.9701


>> Q = formQ( W )

Q =

   -0.2425    0.9701
   -0.9701   -0.2425


>> Q*R

ans =

    1.0000    2.0000
    4.0000    4.0000


>> % Test a larger non-square matrix

>> A = rand( 10 , 6 )

A =

    0.7513    0.8407    0.3517    0.0759    0.1622    0.4505
    0.2551    0.2543    0.8308    0.0540    0.7943    0.0838
    0.5060    0.8143    0.5853    0.5308    0.3112    0.2290
    0.6991    0.2435    0.5497    0.7792    0.5285    0.9133
    0.8909    0.9293    0.9172    0.9340    0.1656    0.1524
    0.9593    0.3500    0.2858    0.1299    0.6020    0.8258
    0.5472    0.1966    0.7572    0.5688    0.2630    0.5383
    0.1386    0.2511    0.7537    0.4694    0.6541    0.9961
    0.1493    0.6160    0.3804    0.0119    0.6892    0.0782
    0.2575    0.4733    0.5678    0.3371    0.7482    0.4427

>> [W,R] = house(A)

W =

    0.8372         0         0         0         0         0
    0.0815    0.7168         0         0         0         0
    0.1616    0.2606   -0.7764         0         0         0
    0.2233   -0.2728    0.2894    0.8531         0         0
    0.2846    0.0967    0.0579    0.3558   -0.8575         0
    0.3064   -0.3629    0.1065   -0.2751    0.3065   -0.8941
    0.1748   -0.2092    0.4173    0.1096   -0.1969    0.0022
    0.0443    0.0915    0.2977    0.2026    0.0619    0.4421
    0.0477    0.3466   -0.1824   -0.0220    0.2629   -0.0631
    0.0823    0.1749    0.0517    0.1283    0.2429   -0.0330


R =

   -1.8696   -1.4969   -1.5884   -1.2332   -1.1268   -1.3909
    0.0000   -0.9718   -0.5487   -0.1682   -0.4045    0.2355
    0.0000   -0.0000    1.0798    0.5867    0.8159    0.5550
    0.0000    0.0000    0.0000   -0.7423    0.4771   -0.0593
    0.0000   -0.0000    0.0000    0.0000    0.7927    0.6278
    0.0000    0.0000    0.0000         0    0.0000    0.7682


>> Q = formQ( W )

Q =

   -0.4018   -0.2462   -0.3905    0.3125   -0.2783    0.4681   -0.1528   -0.4495   -0.0752   -0.0122
   -0.1364   -0.0515    0.5425    0.5945   -0.1345   -0.3583   -0.1852   -0.0778   -0.3044   -0.2270
   -0.2706   -0.4211   -0.0701   -0.2254    0.0009   -0.0304    0.5274    0.2601   -0.5241   -0.2688
   -0.3739    0.3254    0.1244   -0.4038    0.4163   -0.0491   -0.1419   -0.4689   -0.0825   -0.3914
   -0.4765   -0.2222    0.0355   -0.3882   -0.3847   -0.3376   -0.4297    0.2389    0.2209    0.1385
   -0.5131    0.4302   -0.2715    0.3654    0.3091   -0.0141    0.0485    0.4823    0.0299    0.1132
   -0.2927    0.2485    0.3970   -0.0226   -0.3525    0.0941    0.6165   -0.1893    0.3354    0.1814
   -0.0741   -0.1442    0.5157   -0.0689    0.1569    0.7006   -0.2295    0.3516    0.0623   -0.0863
   -0.0799   -0.5109   -0.0248    0.2128    0.3927   -0.1728    0.1558   -0.0549    0.6379   -0.2616
   -0.1377   -0.2749    0.1836   -0.0180    0.4297   -0.0740    0.0071   -0.2283   -0.2173    0.7629


>> A = Q(:,1:6)*R

A =

    0.7513    0.8407    0.3517    0.0759    0.1622    0.4505
    0.2551    0.2543    0.8308    0.0540    0.7943    0.0838
    0.5060    0.8143    0.5853    0.5308    0.3112    0.2290
    0.6991    0.2435    0.5497    0.7792    0.5285    0.9133
    0.8909    0.9293    0.9172    0.9340    0.1656    0.1524
    0.9593    0.3500    0.2858    0.1299    0.6020    0.8258
    0.5472    0.1966    0.7572    0.5688    0.2630    0.5383
    0.1386    0.2511    0.7537    0.4694    0.6541    0.9961
    0.1493    0.6160    0.3804    0.0119    0.6892    0.0782
    0.2575    0.4733    0.5678    0.3371    0.7482    0.4427


>> % Test a singular matrix

>> A = zeros( 3, 3)

A =

     0     0     0
     0     0     0
     0     0     0

>> [W,R] = house(A)

W =

     0     0     0
     0     0     0
     0     0     0


R =

     0     0     0
     0     0     0
     0     0     0


>> Q = formQ( W )

Q =

     1     0     0
     0     1     0
     0     0     1

>> A = Q*R

A =

     0     0     0
     0     0     0
     0     0     0

